<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head> 
  </head>
  
  <body>


    <div style="width:900px; font-family:Arial, 
        sans-serif; font-size:11px; border:1px solid black">
  
        <table id="cm_mapTABLE"> <tbody> <tr id="cm_mapTR">

        <td>
        <div id="cm_map" style="width:700px; height:700px">
          
        </div> 
        </td>
        </tr> 
        </tbody>
        </table>
    </div>

  <script src="http://maps.google.com/maps?file=api&v=2&key=" 
  type="text/javascript">
  </script>

 <script type="text/javascript">
  //<![CDATA[
  var cm_map;
  var cm_mapMarkers = [];
  var cm_mapHTMLS = [];

  // Create a base icon for all of our markers that specifies the
  // shadow, icon dimensions, etc.
  var cm_baseIcon = new GIcon();
  cm_baseIcon.shadow = "http://www.google.com/mapfiles/shadow50.png";
  cm_baseIcon.iconSize = new GSize(20, 34);
  cm_baseIcon.shadowSize = new GSize(37, 34);
  cm_baseIcon.iconAnchor = new GPoint(9, 34);
  cm_baseIcon.infoWindowAnchor = new GPoint(9, 2);
  cm_baseIcon.infoShadowAnchor = new GPoint(18, 25);

  // Change these parameters to customize map
  var param_wsId = "od6";
  // var param_ssKey = "o16162288751915453340.4402783830945175750";
  var param_ssKey = "0An578F7X82D-dHZNeUNZbnFkZTU3UXo2eXlHYk9KN0E";
  var param_useSidebar = true;
  var param_titleColumn = "title";
  var param_descriptionColumn = "description";
  var param_latColumn = "latitude";
  var param_lngColumn = "longitude";
  var param_rankColumn = "rank";
  var param_iconType = "green";
  var param_iconOverType = "orange";

  /**
   * Loads map and calls function to load in worksheet data.
   */
function cm_load()
{  
  if (GBrowserIsCompatible())
  {
    // create the map
    cm_map = new GMap2(document.getElementById("cm_map"));
    cm_map.addControl(new GLargeMapControl());
    cm_map.addControl(new GMapTypeControl());
    cm_map.setCenter(new GLatLng( 43.907787,-79.359741), 2);
    cm_getJSON();
  }
  else
  {
    alert("Sorry, the Google Maps API is not compatible with this browser");
  } 
}

/**
 * Function called when marker on the map is clicked.
 * Opens an info window (bubble) above the marker.
 * @param {Number} markerNum Number of marker in global array
 */
function cm_markerClicked(markerNum)
{
  cm_mapMarkers[markerNum].openInfoWindowHtml(cm_mapHTMLS[markerNum]);
}

/**
 * Function that sorts 2 worksheet rows from JSON feed
 * based on their rank column. Only called if column is defined.
 * @param {rowA} Object Represents row in JSON feed
 * @param {rowB} Object Represents row in JSON feed
 * @return {Number} Difference between row values
 */
function cm_sortRows(rowA, rowB)
{
  var rowAValue = parseFloat(rowA["gsx$" + param_rankColumn].$t);
  var rowBValue = parseFloat(rowB["gsx$" + param_rankColumn].$t);

  return rowAValue - rowBValue;
}


</script>
</body> </html>